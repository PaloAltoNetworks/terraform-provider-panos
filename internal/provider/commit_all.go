package provider

// Note:  This file is automatically generated.  Manually made changes
// will be overwritten when the provider is generated.

import (
	"context"
	"fmt"

	"github.com/PaloAltoNetworks/pango"

	"github.com/hashicorp/terraform-plugin-framework/action"
	"github.com/hashicorp/terraform-plugin-framework/action/schema"
	"github.com/hashicorp/terraform-plugin-framework/attr"
)

var (
	_ action.ActionWithConfigure = &CommitAllAction{}
)

func NewCommitAllAction() action.Action {
	return &CommitAllAction{}
}

type CommitAllAction struct {
	client *pango.Client
}

type CommitAllActionModel struct {
}

func CommitAllActionSchema() schema.Schema {
	return schema.Schema{
		Description: "Commits pending changes and pushes them to all managed devices (Panorama only). This performs a commit-all operation.",
		Attributes:  map[string]schema.Attribute{},
	}
}

func (o *CommitAllActionModel) getTypeFor(name string) attr.Type {
	schema := CommitAllActionSchema()
	if attr, ok := schema.Attributes[name]; !ok {
		panic(fmt.Sprintf("could not resolve schema for attribute %s", name))
	} else {
		switch attr := attr.(type) {
		default:
			return attr.GetType()
		}
	}

	panic("unreachable")
}

func (o *CommitAllAction) Metadata(ctx context.Context, req action.MetadataRequest, resp *action.MetadataResponse) {
	resp.TypeName = req.ProviderTypeName + "_commit_all"
}

func (o *CommitAllAction) Schema(_ context.Context, _ action.SchemaRequest, resp *action.SchemaResponse) {
	resp.Schema = CommitAllActionSchema()
}

func (o *CommitAllAction) Invoke(ctx context.Context, req action.InvokeRequest, resp *action.InvokeResponse) {
	o.InvokeCustom(ctx, req, resp)
}

func (o *CommitAllAction) Configure(ctx context.Context, req action.ConfigureRequest, resp *action.ConfigureResponse) {
	// Prevent panic if the provider has not been configured.
	if req.ProviderData == nil {
		return
	}

	providerData := req.ProviderData.(*ProviderData)
	o.client = providerData.Client
}
