package provider

// Note:  This file is automatically generated.  Manually made changes
// will be overwritten when the provider is generated.

import (
	"context"
	"fmt"

	"github.com/PaloAltoNetworks/pango"

	"github.com/hashicorp/terraform-plugin-framework/attr"
	"github.com/hashicorp/terraform-plugin-framework/ephemeral"
	ephschema "github.com/hashicorp/terraform-plugin-framework/ephemeral/schema"
	"github.com/hashicorp/terraform-plugin-framework/resource"
	"github.com/hashicorp/terraform-plugin-framework/types"
)

// Generate Terraform Ephemeral object
var (
	_ ephemeral.EphemeralResource              = &ApiKeyResource{}
	_ ephemeral.EphemeralResourceWithConfigure = &ApiKeyResource{}
)

func NewApiKeyResource() ephemeral.EphemeralResource {
	return &ApiKeyResource{}
}

type ApiKeyResource struct {
	client *pango.Client
	custom *ApiKeyCustom
}

type ApiKeyResourceModel struct {
	Username types.String `tfsdk:"username"`
	Password types.String `tfsdk:"password"`
	ApiKey   types.String `tfsdk:"api_key"`
}

func (o *ApiKeyResource) ValidateConfig(ctx context.Context, req resource.ValidateConfigRequest, resp *resource.ValidateConfigResponse) {

	var resource ApiKeyResourceModel
	resp.Diagnostics.Append(req.Config.Get(ctx, &resource)...)
	if resp.Diagnostics.HasError() {
		return
	}
}

// <ResourceSchema>

func ApiKeyResourceSchema() ephschema.Schema {
	return ephschema.Schema{
		Attributes: map[string]ephschema.Attribute{

			"username": ephschema.StringAttribute{
				Description: "",
				Required:    true,
			},

			"password": ephschema.StringAttribute{
				Description: "",
				Required:    true,
				Sensitive:   true,
			},

			"api_key": ephschema.StringAttribute{
				Description: "",
				Optional:    true,
				Computed:    true,
				Sensitive:   true,
			},
		},
	}
}

func (o *ApiKeyResourceModel) getTypeFor(name string) attr.Type {
	schema := ApiKeyResourceSchema()
	if attr, ok := schema.Attributes[name]; !ok {
		panic(fmt.Sprintf("could not resolve schema for attribute %s", name))
	} else {
		switch attr := attr.(type) {
		case ephschema.ListNestedAttribute:
			return attr.NestedObject.Type()
		case ephschema.MapNestedAttribute:
			return attr.NestedObject.Type()
		default:
			return attr.GetType()
		}
	}

	panic("unreachable")
}

func (o *ApiKeyResource) Metadata(ctx context.Context, req ephemeral.MetadataRequest, resp *ephemeral.MetadataResponse) {
	resp.TypeName = req.ProviderTypeName + "_api_key"
}

func (o *ApiKeyResource) Schema(_ context.Context, _ ephemeral.SchemaRequest, resp *ephemeral.SchemaResponse) {
	resp.Schema = ApiKeyResourceSchema()
}

// </ResourceSchema>

func (o *ApiKeyResource) Configure(ctx context.Context, req ephemeral.ConfigureRequest, resp *ephemeral.ConfigureResponse) {
	// Prevent panic if the provider has not been configured.
	if req.ProviderData == nil {
		return
	}

	providerData := req.ProviderData.(*ProviderData)
	o.client = providerData.Client
	custom, err := NewApiKeyCustom(providerData)
	if err != nil {
		resp.Diagnostics.AddError("Failed to configure SDK client", err.Error())
		return
	}
	o.custom = custom
}

func (o *ApiKeyResourceModel) AttributeTypes() map[string]attr.Type {

	return map[string]attr.Type{
		"username": types.StringType,
		"password": types.StringType,
		"api_key":  types.StringType,
	}
}

func (o ApiKeyResourceModel) AncestorName() string {
	return ""
}

func (o ApiKeyResourceModel) EntryName() *string {
	return nil
}

func (o *ApiKeyResourceModel) resourceXpathParentComponents() ([]string, error) {
	var components []string
	return components, nil
}

func (o *ApiKeyResource) Open(ctx context.Context, req ephemeral.OpenRequest, resp *ephemeral.OpenResponse) {

	o.OpenCustom(ctx, req, resp)

}

func (o *ApiKeyResource) ImportState(ctx context.Context, req resource.ImportStateRequest, resp *resource.ImportStateResponse) {

}
